
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="NEBULA: A Platform for Decentralized Federated Learning">
      
      
        <meta name="author" content="Enrique Tomás Martínez Beltrán, Alberto Huertas Celdrán, Alejandro Avilés Serrano, Fernando Torres Vega">
      
      
        <link rel="canonical" href="https://docs.nebula-dfl.com/api/core/engine/">
      
      
        <link rel="prev" href="../datasets/nebuladataset/">
      
      
        <link rel="next" href="../eventmanager/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>engine - NEBULA</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/toc.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#documentation-for-engine-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="NEBULA" class="md-header__button md-logo" aria-label="NEBULA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NEBULA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              engine
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/CyberDataLab/nebula" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    CyberDataLab/nebula
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../userguide/" class="md-tabs__link">
        
  
  
    
  
  User Guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../developerguide/" class="md-tabs__link">
        
  
  
    
  
  Developer Guide

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../commercial-faq/" class="md-tabs__link">
        
  
  
    
  
  Commercial FAQ

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="NEBULA" class="md-nav__button md-logo" aria-label="NEBULA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NEBULA
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/CyberDataLab/nebula" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    CyberDataLab/nebula
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../userguide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../developerguide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Developer Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    nebula
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            nebula
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    addons
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1" id="__nav_5_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1">
            <span class="md-nav__icon md-icon"></span>
            addons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/attacks/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    attacks
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_1" id="__nav_5_1_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1">
            <span class="md-nav__icon md-icon"></span>
            attacks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/attacks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    attacks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/attacks/communications/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    communications
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_1_2" id="__nav_5_1_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            communications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/communications/communicationattack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    communicationattack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/communications/delayerattack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    delayerattack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/communications/floodingattack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    floodingattack
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_1_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/attacks/dataset/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    dataset
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_1_3" id="__nav_5_1_1_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1_3">
            <span class="md-nav__icon md-icon"></span>
            dataset
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/dataset/datapoison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    datapoison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/dataset/datasetattack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    datasetattack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/dataset/labelflipping/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    labelflipping
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/attacks/model/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    model
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_1_4" id="__nav_5_1_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/model/gllneuroninversion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gllneuroninversion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/model/modelattack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    modelattack
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/model/modelpoison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    modelpoison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/attacks/model/swappingweights/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    swappingweights
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    env
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    functions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/gps/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    gps
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_4" id="__nav_5_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            gps
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/gps/gpsmodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gpsmodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/gps/nebulagps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nebulagps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/mobility/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mobility
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/networksimulation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    networksimulation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_6" id="__nav_5_1_1_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_6">
            <span class="md-nav__icon md-icon"></span>
            networksimulation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/networksimulation/nebulanetworksimulator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nebulanetworksimulator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/networksimulation/networksimulator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    networksimulator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/reporter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    reporter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/reputation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    reputation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_8" id="__nav_5_1_1_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_8">
            <span class="md-nav__icon md-icon"></span>
            reputation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/reputation/reputation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    reputation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/topologymanager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    topologymanager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_1_10" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../addons/trustworthiness/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    trustworthiness
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_1_10" id="__nav_5_1_1_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_1_10">
            <span class="md-nav__icon md-icon"></span>
            trustworthiness
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/trustworthiness/calculation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calculation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/trustworthiness/factsheet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    factsheet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/trustworthiness/graphics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    graphics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/trustworthiness/metric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    metric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/trustworthiness/pillar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pillar
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/trustworthiness/trustworthiness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    trustworthiness
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/trustworthiness/utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../addons/waf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    waf
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../controller/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    controller
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            controller
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../controller/controller/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    controller
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../controller/database/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    database
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../controller/http_helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    http_helpers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../controller/scenarios/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scenarios
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            core
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../addonmanager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    addonmanager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../aggregation/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    aggregation
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_2" id="__nav_5_1_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_2">
            <span class="md-nav__icon md-icon"></span>
            aggregation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/aggregator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    aggregator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/fedavg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fedavg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/krum/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    krum
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/median/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    median
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/trimmedmean/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    trimmedmean
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_2_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../aggregation/updatehandlers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    updatehandlers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_2_6" id="__nav_5_1_3_2_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_2_6">
            <span class="md-nav__icon md-icon"></span>
            updatehandlers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/updatehandlers/cflupdatehandler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cflupdatehandler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/updatehandlers/dflupdatehandler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dflupdatehandler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/updatehandlers/sdflupdatehandler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sdflupdatehandler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../aggregation/updatehandlers/updatehandler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    updatehandler
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../datasets/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    datasets
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_3" id="__nav_5_1_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_3">
            <span class="md-nav__icon md-icon"></span>
            datasets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/changeablesubset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    changeablesubset
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_3_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../datasets/cifar10/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    cifar10
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_3_2" id="__nav_5_1_3_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_3_2">
            <span class="md-nav__icon md-icon"></span>
            cifar10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/cifar10/cifar10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cifar10
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_3_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../datasets/cifar100/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    cifar100
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_3_3" id="__nav_5_1_3_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            cifar100
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/cifar100/cifar100/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cifar100
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/datamodule/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    datamodule
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_3_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../datasets/emnist/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    emnist
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_3_5" id="__nav_5_1_3_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_3_5">
            <span class="md-nav__icon md-icon"></span>
            emnist
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/emnist/emnist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emnist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_3_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../datasets/fashionmnist/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    fashionmnist
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_3_6" id="__nav_5_1_3_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_3_6">
            <span class="md-nav__icon md-icon"></span>
            fashionmnist
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/fashionmnist/fashionmnist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fashionmnist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_3_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../datasets/mnist/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    mnist
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_3_7" id="__nav_5_1_3_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_3_7">
            <span class="md-nav__icon md-icon"></span>
            mnist
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/mnist/mnist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mnist
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/nebuladataset/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nebuladataset
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    engine
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    engine
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nebula.core.engine" class="md-nav__link">
    <span class="md-ellipsis">
      engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine" class="md-nav__link">
    <span class="md-ellipsis">
      Engine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.aggregator" class="md-nav__link">
    <span class="md-ellipsis">
      aggregator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.cm" class="md-nav__link">
    <span class="md-ellipsis">
      cm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.rb" class="md-nav__link">
    <span class="md-ellipsis">
      rb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.reporter" class="md-nav__link">
    <span class="md-ellipsis">
      reporter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.sa" class="md-nav__link">
    <span class="md-ellipsis">
      sa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.trainer" class="md-nav__link">
    <span class="md-ellipsis">
      trainer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.broadcast_models_include" class="md-nav__link">
    <span class="md-ellipsis">
      broadcast_models_include
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.deploy_components" class="md-nav__link">
    <span class="md-ellipsis">
      deploy_components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.deploy_federation" class="md-nav__link">
    <span class="md-ellipsis">
      deploy_federation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.resolve_missing_updates" class="md-nav__link">
    <span class="md-ellipsis">
      resolve_missing_updates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.start_communications" class="md-nav__link">
    <span class="md-ellipsis">
      start_communications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.update_model_learning_rate" class="md-nav__link">
    <span class="md-ellipsis">
      update_model_learning_rate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.update_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      update_neighbors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.update_self_role" class="md-nav__link">
    <span class="md-ellipsis">
      update_self_role
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../eventmanager/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    eventmanager
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    models
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_6" id="__nav_5_1_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_6">
            <span class="md-nav__icon md-icon"></span>
            models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_6_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/cifar10/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    cifar10
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_6_1" id="__nav_5_1_3_6_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_6_1">
            <span class="md-nav__icon md-icon"></span>
            cifar10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/cifar10/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cnn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/cifar10/cnnV2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cnnV2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/cifar10/cnnV3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cnnV3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/cifar10/fastermobilenet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fastermobilenet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/cifar10/resnet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    resnet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/cifar10/simplemobilenet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    simplemobilenet
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/cifar100/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    cifar100
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_6_2" id="__nav_5_1_3_6_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_6_2">
            <span class="md-nav__icon md-icon"></span>
            cifar100
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/cifar100/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cnn
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_6_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/emnist/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    emnist
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_6_3" id="__nav_5_1_3_6_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_6_3">
            <span class="md-nav__icon md-icon"></span>
            emnist
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/emnist/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cnn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/emnist/mlp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mlp
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_6_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/fashionmnist/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    fashionmnist
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_6_4" id="__nav_5_1_3_6_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_6_4">
            <span class="md-nav__icon md-icon"></span>
            fashionmnist
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/fashionmnist/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cnn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/fashionmnist/mlp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mlp
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_6_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/mnist/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    mnist
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_6_5" id="__nav_5_1_3_6_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_6_5">
            <span class="md-nav__icon md-icon"></span>
            mnist
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/mnist/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cnn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/mnist/mlp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mlp
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/nebulamodel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nebulamodel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_6_7" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../models/sentiment140/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    sentiment140
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_6_7" id="__nav_5_1_3_6_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_6_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_6_7">
            <span class="md-nav__icon md-icon"></span>
            sentiment140
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/sentiment140/cnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cnn
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/sentiment140/rnn/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rnn
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nebulaevents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nebulaevents
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_8" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../network/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    network
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_8" id="__nav_5_1_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_8">
            <span class="md-nav__icon md-icon"></span>
            network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    actions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/blacklist/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    blacklist
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/communications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    communications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/connection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    connection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/discoverer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    discoverer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_8_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../network/externalconnection/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    externalconnection
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_8_6" id="__nav_5_1_3_8_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_8_6">
            <span class="md-nav__icon md-icon"></span>
            externalconnection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/externalconnection/externalconnectionservice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    externalconnectionservice
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/externalconnection/nebuladiscoveryservice/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nebuladiscoveryservice
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/forwarder/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    forwarder
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/health/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    health
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/messages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    messages
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../network/propagator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    propagator
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../node/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    node
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../noderole/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    noderole
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_11" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../pb/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    pb
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_11" id="__nav_5_1_3_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_11">
            <span class="md-nav__icon md-icon"></span>
            pb
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pb/nebula_pb2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    nebula_pb2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../role/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    role
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    situationalawareness
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13" id="__nav_5_1_3_13_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13">
            <span class="md-nav__icon md-icon"></span>
            situationalawareness
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/awareness/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    awareness
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_1" id="__nav_5_1_3_13_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_13_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_1">
            <span class="md-nav__icon md-icon"></span>
            awareness
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_1_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/awareness/arbitrationpolicies/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    arbitrationpolicies
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_1_1" id="__nav_5_1_3_13_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_3_13_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_1_1">
            <span class="md-nav__icon md-icon"></span>
            arbitrationpolicies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/arbitrationpolicies/arbitrationpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    arbitrationpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/arbitrationpolicies/staticarbitrationpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    staticarbitrationpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_1_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/awareness/sanetwork/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    sanetwork
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_1_2" id="__nav_5_1_3_13_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_3_13_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_1_2">
            <span class="md-nav__icon md-icon"></span>
            sanetwork
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_1_2_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/awareness/sanetwork/neighborpolicies/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    neighborpolicies
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_1_2_1" id="__nav_5_1_3_13_1_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_5_1_3_13_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            neighborpolicies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sanetwork/neighborpolicies/distanceneighborpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    distanceneighborpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sanetwork/neighborpolicies/fcneighborpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fcneighborpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sanetwork/neighborpolicies/idleneighborpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    idleneighborpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sanetwork/neighborpolicies/neighborpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    neighborpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sanetwork/neighborpolicies/ringneighborpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ringneighborpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sanetwork/neighborpolicies/starneighborpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    starneighborpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sanetwork/sanetwork/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sanetwork
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sareasoner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sareasoner
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/awareness/satraining/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    satraining
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_1_4" id="__nav_5_1_3_13_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_3_13_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_1_4">
            <span class="md-nav__icon md-icon"></span>
            satraining
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/satraining/satraining/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    satraining
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_1_4_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/awareness/satraining/trainingpolicy/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    trainingpolicy
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_1_4_2" id="__nav_5_1_3_13_1_4_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="7" aria-labelledby="__nav_5_1_3_13_1_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_1_4_2">
            <span class="md-nav__icon md-icon"></span>
            trainingpolicy
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/satraining/trainingpolicy/bpstrainingpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    bpstrainingpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/satraining/trainingpolicy/fastreboot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fastreboot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/satraining/trainingpolicy/htstrainingpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    htstrainingpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/satraining/trainingpolicy/qdstrainingpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    qdstrainingpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/satraining/trainingpolicy/trainingpolicy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    trainingpolicy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/awareness/sautils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    sautils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_1_5" id="__nav_5_1_3_13_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_3_13_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_1_5">
            <span class="md-nav__icon md-icon"></span>
            sautils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sautils/sacommand/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sacommand
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sautils/samoduleagent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    samoduleagent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/sautils/sasystemmonitor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sasystemmonitor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/awareness/suggestionbuffer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    suggestionbuffer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/discovery/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    discovery
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_2" id="__nav_5_1_3_13_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_5_1_3_13_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_2">
            <span class="md-nav__icon md-icon"></span>
            discovery
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_2_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/discovery/candidateselection/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    candidateselection
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_2_1" id="__nav_5_1_3_13_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_3_13_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_2_1">
            <span class="md-nav__icon md-icon"></span>
            candidateselection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/candidateselection/candidateselector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    candidateselector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/candidateselection/distcandidateselector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    distcandidateselector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/candidateselection/fccandidateselector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fccandidateselector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/candidateselection/ringcandidateselector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ringcandidateselector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/candidateselection/stdcandidateselector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    stdcandidateselector
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/federationconnector/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    federationconnector
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_13_2_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../situationalawareness/discovery/modelhandlers/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    modelhandlers
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_13_2_3" id="__nav_5_1_3_13_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="6" aria-labelledby="__nav_5_1_3_13_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_13_2_3">
            <span class="md-nav__icon md-icon"></span>
            modelhandlers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/modelhandlers/aggmodelhandler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    aggmodelhandler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/modelhandlers/defaultmodelhandler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    defaultmodelhandler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/modelhandlers/modelhandler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    modelhandler
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/discovery/modelhandlers/stdmodelhandler/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    stdmodelhandler
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../situationalawareness/situationalawareness/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    situationalawareness
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3_14" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../training/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    training
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_3_14" id="__nav_5_1_3_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_3_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3_14">
            <span class="md-nav__icon md-icon"></span>
            training
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/lightning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    lightning
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/scikit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scikit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../training/siamese/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    siamese
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../frontend/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    frontend
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            frontend
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../frontend/app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    app
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../physical/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    physical
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_1_5" id="__nav_5_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_5">
            <span class="md-nav__icon md-icon"></span>
            physical
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../physical/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    api
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../commercial-faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commercial FAQ
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nebula.core.engine" class="md-nav__link">
    <span class="md-ellipsis">
      engine
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine" class="md-nav__link">
    <span class="md-ellipsis">
      Engine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.aggregator" class="md-nav__link">
    <span class="md-ellipsis">
      aggregator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.cm" class="md-nav__link">
    <span class="md-ellipsis">
      cm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.rb" class="md-nav__link">
    <span class="md-ellipsis">
      rb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.reporter" class="md-nav__link">
    <span class="md-ellipsis">
      reporter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.sa" class="md-nav__link">
    <span class="md-ellipsis">
      sa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.trainer" class="md-nav__link">
    <span class="md-ellipsis">
      trainer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.broadcast_models_include" class="md-nav__link">
    <span class="md-ellipsis">
      broadcast_models_include
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.deploy_components" class="md-nav__link">
    <span class="md-ellipsis">
      deploy_components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.deploy_federation" class="md-nav__link">
    <span class="md-ellipsis">
      deploy_federation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.resolve_missing_updates" class="md-nav__link">
    <span class="md-ellipsis">
      resolve_missing_updates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.start_communications" class="md-nav__link">
    <span class="md-ellipsis">
      start_communications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.update_model_learning_rate" class="md-nav__link">
    <span class="md-ellipsis">
      update_model_learning_rate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.update_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      update_neighbors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nebula.core.engine.Engine.update_self_role" class="md-nav__link">
    <span class="md-ellipsis">
      update_self_role
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  



  
  


<h1 id="documentation-for-engine-module">Documentation for Engine Module<a class="headerlink" href="#documentation-for-engine-module" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="nebula.core.engine"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="nebula.core.engine.Engine" class="doc doc-heading">
            <code>Engine</code>


<a href="#nebula.core.engine.Engine" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">








              <details class="quote">
                <summary>Source code in <code>nebula/core/engine.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Engine</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">,</span>
        <span class="n">datamodule</span><span class="p">,</span>
        <span class="n">config</span><span class="o">=</span><span class="n">Config</span><span class="p">,</span>
        <span class="n">trainer</span><span class="o">=</span><span class="n">Lightning</span><span class="p">,</span>
        <span class="n">security</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;idx&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment_name</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;scenario_args&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ip</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;network_args&quot;</span><span class="p">][</span><span class="s2">&quot;ip&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;network_args&quot;</span><span class="p">][</span><span class="s2">&quot;port&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">addr</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;network_args&quot;</span><span class="p">][</span><span class="s2">&quot;addr&quot;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">docker</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

        <span class="n">print_banner</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_trainer</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aggregator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">federation_nodes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_federation_nodes_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="s2">&quot;federation_nodes_lock&quot;</span><span class="p">,</span> <span class="n">async_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;tracking_args&quot;</span><span class="p">][</span><span class="s2">&quot;log_dir&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">experiment_name</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">security</span> <span class="o">=</span> <span class="n">security</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_trainer</span> <span class="o">=</span> <span class="n">trainer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">datamodule</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_aggregator</span> <span class="o">=</span> <span class="n">create_aggregator</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_secure_neighbors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_malicious</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;adversarial_args&quot;</span><span class="p">][</span><span class="s2">&quot;attack_params&quot;</span><span class="p">][</span><span class="s2">&quot;attacks&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;No Attack&quot;</span>

        <span class="n">role</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;role&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_role_behavior</span><span class="p">:</span> <span class="n">RoleBehavior</span> <span class="o">=</span> <span class="n">factory_role_behavior</span><span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_role_behavior_performance_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="s2">&quot;role_behavior_performance_lock&quot;</span><span class="p">,</span> <span class="n">async_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">print_msg_box</span><span class="p">(</span>
            <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Name </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s2">Role: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_role_behavior</span><span class="o">.</span><span class="n">get_role_name</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Node information&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Trainer: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_trainer</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Dataset: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s1">&#39;data_args&#39;</span><span class="p">][</span><span class="s1">&#39;dataset&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">IID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s1">&#39;data_args&#39;</span><span class="p">][</span><span class="s1">&#39;iid&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Model: </span><span class="si">{</span><span class="n">model</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Aggregation algorithm: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_aggregator</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Node behavior: </span><span class="si">{</span><span class="s1">&#39;malicious&#39;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">_is_malicious</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;benign&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">print_msg_box</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Scenario information&quot;</span><span class="p">)</span>
        <span class="n">print_msg_box</span><span class="p">(</span>
            <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Logging type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_trainer</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Logging information&quot;</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;learning_cycle_lock&quot;</span><span class="p">,</span> <span class="n">async_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">federation_setup_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;federation_setup_lock&quot;</span><span class="p">,</span> <span class="n">async_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">federation_ready_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;federation_ready_lock&quot;</span><span class="p">,</span> <span class="n">async_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">round_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;round_lock&quot;</span><span class="p">,</span> <span class="n">async_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_round_in_process_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="s2">&quot;round_in_process_lock&quot;</span><span class="p">,</span> <span class="n">async_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">reload_config_file</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cm</span> <span class="o">=</span> <span class="n">CommunicationsManager</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_reporter</span> <span class="o">=</span> <span class="n">Reporter</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">trainer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_sinchronized_status</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sinchronized_status_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sinchronized_status_lock&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trainning_in_progress_lock</span> <span class="o">=</span> <span class="n">Locker</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;trainning_in_progress_lock&quot;</span><span class="p">,</span> <span class="n">async_lock</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">event_manager</span> <span class="o">=</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_addon_manager</span> <span class="o">=</span> <span class="n">AddondManager</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># Additional Components</span>
        <span class="k">if</span> <span class="s2">&quot;situational_awareness&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_situational_awareness</span> <span class="o">=</span> <span class="n">SituationalAwareness</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_situational_awareness</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;defense_args&quot;</span><span class="p">][</span><span class="s2">&quot;reputation&quot;</span><span class="p">][</span><span class="s2">&quot;enabled&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reputation</span> <span class="o">=</span> <span class="n">Reputation</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">cm</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Communication Manager&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cm</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">reporter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reporter&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reporter</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">aggregator</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Aggregator&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_aggregator</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">trainer</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trainer&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_trainer</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">rb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Role Behavior&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_role_behavior</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sa</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Situational Awareness Module&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_situational_awareness</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_aggregator_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aggregator</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_addr</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_federation_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_federation_nodes_lock</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">federation_nodes</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_federation_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">federation_nodes</span><span class="p">):</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_federation_nodes_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">federation_nodes</span> <span class="o">=</span> <span class="n">federation_nodes</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_initialization_status</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_initialization_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">status</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="n">status</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">get_round</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_lock</span><span class="p">:</span>
            <span class="n">current_round</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">round</span>
        <span class="k">return</span> <span class="n">current_round</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_federation_ready_lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">federation_ready_lock</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_federation_setup_lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">federation_setup_lock</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_trainning_in_progress_lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainning_in_progress_lock</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_round_lock</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">round_lock</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_round</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_round</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🤖  Update round count | from: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="si">}</span><span class="s2"> | to round: </span><span class="si">{</span><span class="n">new_round</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="o">=</span> <span class="n">new_round</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">set_current_round</span><span class="p">(</span><span class="n">new_round</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;                                                     ##############################</span>
<span class="sd">                                                            #       MODEL CALLBACKS      #</span>
<span class="sd">                                                            ##############################</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">model_initialization_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🤖  handle_model_message | Received model initialization from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">deserialize_model</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">set_model_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🤖  Init Model | Model Parameters Initialized&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initialization_status</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">await</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
            <span class="p">)</span>  <span class="c1"># Enable learning cycle once the initialization is done</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
                <span class="p">)</span>  <span class="c1"># Release the lock acquired at the beginning of the engine</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">model_update_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🤖  handle_model_message | Received model update from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> with round </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">round</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">locked</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_nodes</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🤖  handle_model_message | There are no defined federation nodes&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">decoded_model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">deserialize_model</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span>
        <span class="n">updt_received_event</span> <span class="o">=</span> <span class="n">UpdateReceivedEvent</span><span class="p">(</span><span class="n">decoded_model</span><span class="p">,</span> <span class="n">message</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="o">.</span><span class="n">round</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">publish_node_event</span><span class="p">(</span><span class="n">updt_received_event</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;                                                     ##############################</span>
<span class="sd">                                                            #      General callbacks     #</span>
<span class="sd">                                                            ##############################</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_discovery_discover_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;🔍  handle_discovery_message | Trigger | Received discovery message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> (network propagation)&quot;</span>
        <span class="p">)</span>
        <span class="n">current_connections</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">myself</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_connections</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔍  handle_discovery_message | Trigger | Connecting to </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> indirectly&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">direct</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_connections_lock</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span>
                <span class="c1"># Update the latitude and longitude of the node (if already connected)</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">message</span><span class="o">.</span><span class="n">latitude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="o">-</span><span class="mi">90</span> <span class="o">&lt;=</span> <span class="n">message</span><span class="o">.</span><span class="n">latitude</span> <span class="o">&lt;=</span> <span class="mi">90</span>
                    <span class="ow">and</span> <span class="n">message</span><span class="o">.</span><span class="n">longitude</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="o">-</span><span class="mi">180</span> <span class="o">&lt;=</span> <span class="n">message</span><span class="o">.</span><span class="n">longitude</span> <span class="o">&lt;=</span> <span class="mi">180</span>
                <span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">update_geolocation</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">message</span><span class="o">.</span><span class="n">longitude</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;🔍  Invalid geolocation received from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">: latitude=</span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">latitude</span><span class="si">}</span><span class="s2">, longitude=</span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">longitude</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_control_alive_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔧  handle_control_message | Trigger | Received alive message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">current_connections</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">myself</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">current_connections</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">health</span><span class="o">.</span><span class="n">alive</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating alive status in connection: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❗️  Connection </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> not found in connections...&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_control_leadership_transfer_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔧  handle_control_message | Trigger | Received leadership transfer message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_in_process_lock</span><span class="o">.</span><span class="n">locked_async</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Learning cycle is executing, role behavior will be modified next round&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">set_next_role</span><span class="p">(</span><span class="n">Role</span><span class="o">.</span><span class="n">AGGREGATOR</span><span class="p">,</span> <span class="n">source_to_notificate</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Trying to modify Role behavior&quot;</span><span class="p">)</span>
                <span class="n">lock_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_round_in_process_lock</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">())</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">lock_task</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_role_behavior</span> <span class="o">=</span> <span class="n">change_role_behavior</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="p">,</span> <span class="n">Role</span><span class="o">.</span><span class="n">AGGREGATOR</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">set_next_role</span><span class="p">(</span><span class="n">Role</span><span class="o">.</span><span class="n">AGGREGATOR</span><span class="p">,</span> <span class="n">source_to_notificate</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_self_role</span><span class="p">()</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_in_process_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Learning cycle is locked, role behavior will be modified next round&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">set_next_role</span><span class="p">(</span><span class="n">Role</span><span class="o">.</span><span class="n">AGGREGATOR</span><span class="p">,</span> <span class="n">source_to_notificate</span><span class="o">=</span><span class="n">source</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_control_leadership_transfer_ack_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔧  handle_control_message | Trigger | Received leadership transfer ack message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># No concurrence of difference ack received treated, be aware of that.</span>
        <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_in_process_lock</span><span class="o">.</span><span class="n">locked_async</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Learning cycle is executing, role behavior will be modified next round&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">set_next_role</span><span class="p">(</span><span class="n">Role</span><span class="o">.</span><span class="n">TRAINER</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">lock_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_round_in_process_lock</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">())</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">lock_task</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Role behavior could be executed...&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">set_next_role</span><span class="p">(</span><span class="n">Role</span><span class="o">.</span><span class="n">TRAINER</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_self_role</span><span class="p">()</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_in_process_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>

            <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Learning cycle is locked, role behavior will be modified next round&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">set_next_role</span><span class="p">(</span><span class="n">Role</span><span class="o">.</span><span class="n">TRAINER</span><span class="p">)</span>


    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_connection_connect_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔗  handle_connection_message | Trigger | Received connection message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">current_connections</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">myself</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">source</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">current_connections</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔗  handle_connection_message | Trigger | Connecting to </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">direct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_connection_disconnect_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔗  handle_connection_message | Trigger | Received disconnection message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">mutual_disconnection</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_federation_federation_ready_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📝  handle_federation_message | Trigger | Received ready federation message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📝  handle_federation_message | Trigger | Adding ready connection </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">add_ready_connection</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_federation_federation_start_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📝  handle_federation_message | Trigger | Received start federation message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_trainer_module</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_federation_federation_models_included_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📝  handle_federation_message | Trigger | Received aggregation finished message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">current_round</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_connections_lock</span><span class="p">()</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">current_round</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">connections</span><span class="p">[</span><span class="n">source</span><span class="p">]</span><span class="o">.</span><span class="n">update_round</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">if</span> <span class="n">message</span><span class="o">.</span><span class="n">round</span> <span class="ow">in</span> <span class="p">[</span>
                            <span class="n">current_round</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                            <span class="n">current_round</span><span class="p">,</span>
                        <span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating round in connection: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Connection not found for </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error updating round in connection: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_connections_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_reputation_share_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;handle_reputation_message | Trigger | Received reputation message from </span><span class="si">{</span><span class="n">source</span><span class="si">}</span><span class="s2"> | Node: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">node_id</span><span class="si">}</span><span class="s2"> | Score: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">score</span><span class="si">}</span><span class="s2"> | Round: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">round</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">current_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr</span>
            <span class="n">nei</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">node_id</span>

            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_reputation&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reputation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">current_node</span> <span class="o">!=</span> <span class="n">nei</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_node</span><span class="p">,</span> <span class="n">nei</span><span class="p">,</span> <span class="n">message</span><span class="o">.</span><span class="n">round</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reputation</span><span class="o">.</span><span class="n">reputation_with_all_feedback</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_reputation</span><span class="o">.</span><span class="n">reputation_with_all_feedback</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_reputation</span><span class="o">.</span><span class="n">reputation_with_all_feedback</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">score</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error handling reputation message: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;                                                     ##############################</span>
<span class="sd">                                                            #    REGISTERING CALLBACKS   #</span>
<span class="sd">                                                            ##############################</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">register_events_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_message_callbacks</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">subscribe_node_event</span><span class="p">(</span><span class="n">AggregationEvent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">broadcast_models_include</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">init_message_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Registering callbacks for MessageEvents...&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_message_events_callbacks</span><span class="p">()</span>
        <span class="c1"># Additional callbacks not registered automatically</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_message_callback</span><span class="p">((</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;initialization&quot;</span><span class="p">),</span> <span class="s2">&quot;model_initialization_callback&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_message_callback</span><span class="p">((</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="s2">&quot;update&quot;</span><span class="p">),</span> <span class="s2">&quot;model_update_callback&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">register_message_events_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">me_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_messages_events</span><span class="p">()</span>
        <span class="n">message_events</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">message_name</span><span class="p">,</span> <span class="n">message_action</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">message_name</span><span class="p">,</span> <span class="n">message_actions</span><span class="p">)</span> <span class="ow">in</span> <span class="n">me_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">message_action</span> <span class="ow">in</span> <span class="n">message_actions</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">event_type</span><span class="p">,</span> <span class="n">action</span> <span class="ow">in</span> <span class="n">message_events</span><span class="p">:</span>
            <span class="n">callback_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;_</span><span class="si">{</span><span class="n">event_type</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">action</span><span class="si">}</span><span class="s2">_callback&quot;</span>
            <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback_name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
                <span class="k">await</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">subscribe</span><span class="p">((</span><span class="n">event_type</span><span class="p">,</span> <span class="n">action</span><span class="p">),</span> <span class="n">method</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">register_message_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message_event</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">callback</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">event_type</span><span class="p">,</span> <span class="n">action</span> <span class="o">=</span> <span class="n">message_event</span>
        <span class="n">method</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">method</span><span class="p">):</span>
            <span class="k">await</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">subscribe</span><span class="p">((</span><span class="n">event_type</span><span class="p">,</span> <span class="n">action</span><span class="p">),</span> <span class="n">method</span><span class="p">)</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;                                                     ##############################</span>
<span class="sd">                                                            #    ENGINE FUNCTIONALITY    #</span>
<span class="sd">                                                            ##############################</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_aditional_node_start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the initialization process for an additional node joining the federation.</span>

<span class="sd">        This method triggers the situational awareness module to initiate a late connection</span>
<span class="sd">        process to discover and join the federation. Once connected, it starts the learning</span>
<span class="sd">        process asynchronously.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Aditional node | </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">addr</span><span class="si">}</span><span class="s2"> | going to stablish connection with federation&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">sa</span><span class="o">.</span><span class="n">start_late_connection_process</span><span class="p">()</span>
        <span class="c1"># continue ..</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating trainer service to start the federation process..&quot;</span><span class="p">)</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_learning_late</span><span class="p">())</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">removed_neighbor_addr</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the internal list of federation neighbors and publishes a neighbor update event.</span>

<span class="sd">        Args:</span>
<span class="sd">            removed_neighbor_addr (str): Address of the neighbor that was removed (or affected).</span>
<span class="sd">            neighbors (set): The updated set of current federation neighbors.</span>
<span class="sd">            remove (bool): Flag indicating whether the specified neighbor was removed (True)</span>
<span class="sd">                        or added (False).</span>

<span class="sd">        Publishes:</span>
<span class="sd">            UpdateNeighborEvent: An event describing the neighbor update, for use by listeners.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_federation_nodes</span><span class="p">(</span><span class="n">neighbors</span><span class="p">)</span>
        <span class="n">updt_nei_event</span> <span class="o">=</span> <span class="n">UpdateNeighborEvent</span><span class="p">(</span><span class="n">removed_neighbor_addr</span><span class="p">,</span> <span class="n">remove</span><span class="p">)</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">publish_node_event</span><span class="p">(</span><span class="n">updt_nei_event</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">broadcast_models_include</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="n">AggregationEvent</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Broadcasts a message to federation neighbors indicating that aggregation is ready.</span>

<span class="sd">        Args:</span>
<span class="sd">            age (AggregationEvent): The event containing information about the completed aggregation.</span>

<span class="sd">        Sends:</span>
<span class="sd">            federation_models_included: A message containing the round number of the aggregation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔄  Broadcasting MODELS_INCLUDED for round </span><span class="si">{</span><span class="k">await</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">get_round</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">current_round</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round</span><span class="p">()</span>
        <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
            <span class="s2">&quot;federation&quot;</span><span class="p">,</span> <span class="s2">&quot;federation_models_included&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="n">current_round</span><span class="p">]]</span>
        <span class="p">)</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">send_message_to_neighbors</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_model_learning_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_lr</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the learning rate of the current training model.</span>

<span class="sd">        Args:</span>
<span class="sd">            new_lr (float): The new learning rate to apply to the trainer model.</span>

<span class="sd">        This method ensures that the operation is protected by a lock to avoid</span>
<span class="sd">        conflicts with ongoing training operations.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainning_in_progress_lock</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Update | learning rate modified...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">update_model_learning_rate</span><span class="p">(</span><span class="n">new_lr</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainning_in_progress_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start_learning_late</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the training process for a node joining the federation after it has already started.</span>

<span class="sd">        This method retrieves the training configuration from the situational awareness module,</span>
<span class="sd">        including the model parameters, total number of training rounds, current round, and number</span>
<span class="sd">        of epochs. It initializes the model and the trainer accordingly, and starts the learning cycle.</span>

<span class="sd">        Locks:</span>
<span class="sd">            - Acquires and releases `learning_cycle_lock` to ensure exclusive access during setup.</span>
<span class="sd">            - Acquires and updates `round` via `round_lock`.</span>
<span class="sd">            - Releases `federation_ready_lock` to indicate that the node is ready to begin learning.</span>

<span class="sd">        Handles:</span>
<span class="sd">            - Late start by setting model parameters and synchronization state.</span>
<span class="sd">            - Runtime exceptions gracefully in case of double lock releases or other race conditions.</span>

<span class="sd">        Logs important initialization information and direct connection state before training begins.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">model_serialized</span><span class="p">,</span> <span class="n">rounds</span><span class="p">,</span> <span class="nb">round</span><span class="p">,</span> <span class="n">_epochs</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">sa</span><span class="o">.</span><span class="n">get_trainning_info</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span> <span class="o">=</span> <span class="n">rounds</span>
            <span class="n">epochs</span> <span class="o">=</span> <span class="n">_epochs</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round_lock</span><span class="p">()</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="o">=</span> <span class="nb">round</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
            <span class="n">print_msg_box</span><span class="p">(</span>
                <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Starting Federated Learning process...&quot;</span><span class="p">,</span>
                <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Start of the experiment late&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trainning setup | total rounds: </span><span class="si">{</span><span class="n">rounds</span><span class="si">}</span><span class="s2"> | current round: </span><span class="si">{</span><span class="nb">round</span><span class="si">}</span><span class="s2"> | epochs: </span><span class="si">{</span><span class="n">epochs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">direct_connections</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">only_direct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initial DIRECT connections: </span><span class="si">{</span><span class="n">direct_connections</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🤖  Initializing model...&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">model</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">deserialize_model</span><span class="p">(</span><span class="n">model_serialized</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">set_model_parameters</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Model Parameters Initialized&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_initialization_status</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">await</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
                <span class="p">)</span>  <span class="c1"># Enable learning cycle once the initialization is done</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">await</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
                    <span class="p">)</span>  <span class="c1"># Release the lock acquired at the beginning of the engine</span>
                <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">set_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">set_current_round</span><span class="p">(</span><span class="nb">round</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">create_trainer</span><span class="p">()</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_learning_cycle</span><span class="p">()</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">locked_async</span><span class="p">():</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">create_trainer_module</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_start_learning</span><span class="p">())</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Started trainer module...&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_communications</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes communication with neighboring nodes and registers internal event callbacks.</span>

<span class="sd">        This method performs the following steps:</span>
<span class="sd">        1. Registers all event callbacks used by the node.</span>
<span class="sd">        2. Parses the list of initial neighbors from the configuration and initiates communications with them.</span>
<span class="sd">        3. Waits for half of the configured grace time to allow initial network stabilization.</span>

<span class="sd">        This grace period provides time for initial peer discovery and message exchange</span>
<span class="sd">        before other services or training processes begin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_events_callbacks</span><span class="p">()</span>
        <span class="n">initial_neighbors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;network_args&quot;</span><span class="p">][</span><span class="s2">&quot;neighbors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">start_communications</span><span class="p">(</span><span class="n">initial_neighbors</span><span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;misc_args&quot;</span><span class="p">][</span><span class="s2">&quot;grace_time_connection&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">deploy_components</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes and deploys the core components required for node operation in the federation.</span>

<span class="sd">        This method performs the following actions:</span>
<span class="sd">        1. Initializes the aggregator, which handles the model aggregation process.</span>
<span class="sd">        2. Optionally initializes the situational awareness module if enabled in the configuration.</span>
<span class="sd">        3. Sets up the reputation system if enabled.</span>
<span class="sd">        4. Starts the reporting service for logging and monitoring purposes.</span>
<span class="sd">        5. Deploys any additional add-ons registered via the addon manager.</span>

<span class="sd">        This method ensures all critical and optional components are ready before</span>
<span class="sd">        the federated learning process starts.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregator</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;situational_awareness&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">sa</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;defense_args&quot;</span><span class="p">][</span><span class="s2">&quot;reputation&quot;</span><span class="p">][</span><span class="s2">&quot;enabled&quot;</span><span class="p">]:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reputation</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reporter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addon_manager</span><span class="o">.</span><span class="n">deploy_additional_services</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">deploy_federation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Manages the startup logic for the federated learning process.</span>

<span class="sd">        The behavior is determined by the configuration:</span>
<span class="sd">        - If the device is responsible for starting the federation:</span>
<span class="sd">        1. Waits for a configured grace period to allow peers to initialize.</span>
<span class="sd">        2. Waits until the network is ready (all nodes are prepared).</span>
<span class="sd">        3. Sends a &#39;FEDERATION_START&#39; message to notify neighbors.</span>
<span class="sd">        4. Initializes the trainer module and marks the node as ready.</span>

<span class="sd">        - If the device is not the starter:</span>
<span class="sd">        1. Sends a &#39;FEDERATION_READY&#39; message to neighbors.</span>
<span class="sd">        2. Waits passively for a start signal from the initiating node.</span>

<span class="sd">        This function ensures proper synchronization and coordination before the federated rounds begin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">federation_ready_lock</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;💤  Waiting for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s1">&#39;misc_args&#39;</span><span class="p">][</span><span class="s1">&#39;grace_time_start_federation&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> seconds to start the federation&quot;</span>
            <span class="p">)</span>
            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;misc_args&quot;</span><span class="p">][</span><span class="s2">&quot;grace_time_start_federation&quot;</span><span class="p">])</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">while</span> <span class="ow">not</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">check_federation_ready</span><span class="p">():</span>
                    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sending FEDERATION_START to neighbors...&quot;</span><span class="p">)</span>
                <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="s2">&quot;federation&quot;</span><span class="p">,</span> <span class="s2">&quot;federation_start&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">send_message_to_neighbors</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_trainer_module</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_initialization_status</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Federation already started&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sending FEDERATION_READY to neighbors...&quot;</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="s2">&quot;federation&quot;</span><span class="p">,</span> <span class="s2">&quot;federation_ready&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">send_message_to_neighbors</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;💤  Waiting until receiving the start signal from the start node&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_start_learning</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts the federated learning process from the beginning if no prior round exists.</span>

<span class="sd">        This method performs the following sequence:</span>
<span class="sd">        1. Acquires the learning cycle lock to ensure exclusive execution.</span>
<span class="sd">        2. If no round has been initialized:</span>
<span class="sd">        - Reads total rounds and epochs from the configuration.</span>
<span class="sd">        - Sets the initial round to 0 and releases the round lock.</span>
<span class="sd">        - Waits for the federation to be ready if the device is not the starter.</span>
<span class="sd">        - If the device is the starter, it propagates the initial model to neighbors.</span>
<span class="sd">        - Sets the number of epochs and creates the trainer instance.</span>
<span class="sd">        - Initiates the federated learning cycle.</span>
<span class="sd">        3. If a round already exists and the lock is still held, it is released to avoid deadlock.</span>

<span class="sd">        This method ensures that the learning process is initialized safely and only once,</span>
<span class="sd">        synchronizing startup across nodes and managing dependencies on federation readiness.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;scenario_args&quot;</span><span class="p">][</span><span class="s2">&quot;rounds&quot;</span><span class="p">]</span>
                <span class="n">epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;training_args&quot;</span><span class="p">][</span><span class="s2">&quot;epochs&quot;</span><span class="p">]</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round_lock</span><span class="p">()</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
                <span class="n">print_msg_box</span><span class="p">(</span>
                    <span class="n">msg</span><span class="o">=</span><span class="s2">&quot;Starting Federated Learning process...&quot;</span><span class="p">,</span>
                    <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Start of the experiment&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">direct_connections</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">only_direct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">undirected_connections</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">only_undirected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Initial DIRECT connections: </span><span class="si">{</span><span class="n">direct_connections</span><span class="si">}</span><span class="s2"> | Initial UNDIRECT participants: </span><span class="si">{</span><span class="n">undirected_connections</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;💤  Waiting initialization of the federation...&quot;</span><span class="p">)</span>
                <span class="c1"># Lock to wait for the federation to be ready (only affects the first round, when the learning starts)</span>
                <span class="c1"># Only applies to non-start nodes --&gt; start node does not wait for the federation to be ready</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Propagate initial model updates.&quot;</span><span class="p">)</span>

                    <span class="n">mpe</span> <span class="o">=</span> <span class="n">ModelPropagationEvent</span><span class="p">(</span><span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">only_direct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">myself</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="s2">&quot;initialization&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">publish_node_event</span><span class="p">(</span><span class="n">mpe</span><span class="p">)</span>

                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">set_epochs</span><span class="p">(</span><span class="n">epochs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">create_trainer</span><span class="p">()</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_learning_cycle</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">locked_async</span><span class="p">():</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">locked_async</span><span class="p">():</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_cycle_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_waiting_model_updates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Waits for the model aggregation results and updates the local model accordingly.</span>

<span class="sd">        This method:</span>
<span class="sd">        1. Awaits the result of the aggregation from the aggregator component.</span>
<span class="sd">        2. If aggregation parameters are successfully received:</span>
<span class="sd">        - Updates the local model with the aggregated parameters.</span>
<span class="sd">        3. If no parameters are returned:</span>
<span class="sd">        - Logs an error indicating aggregation failure.</span>

<span class="sd">        This method is called after local training and before proceeding to the next round,</span>
<span class="sd">        ensuring the model is synchronized with the federation&#39;s latest aggregated state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;💤  Waiting convergence in round </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">params</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregator</span><span class="o">.</span><span class="n">get_aggregation</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">params</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;_waiting_model_updates | Aggregation done for round </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="si">}</span><span class="s2">, including parameters in local model.&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">set_model_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Aggregation finished with no parameters&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">print_round_information</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">print_msg_box</span><span class="p">(</span>
            <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Round </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="si">}</span><span class="s2"> started.&quot;</span><span class="p">,</span>
            <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Round information&quot;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">learning_cycle_finished</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">current_round</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">current_round</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">current_round</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">resolve_missing_updates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Delegates the resolution strategy for missing updates to the current role behavior.</span>

<span class="sd">        This function is called when the node receives no model updates from neighbors</span>
<span class="sd">        and needs to apply a fallback strategy depending on its role (e.g., using default weights</span>
<span class="sd">        if aggregator, or local model if trainer).</span>

<span class="sd">        Returns:</span>
<span class="sd">            The result of the role-specific resolution strategy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using Role behavior: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_role_name</span><span class="p">()</span><span class="si">}</span><span class="s2"> conflict resolve strategy&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">resolve_missing_updates</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_self_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks whether a role update is required and performs the transition if necessary.</span>

<span class="sd">        If a new role has been assigned (i.e., self.rb.update_role_needed() is True),</span>
<span class="sd">        this function updates the role behavior accordingly and notifies the source</span>
<span class="sd">        that initiated the role transfer, if applicable.</span>

<span class="sd">        It logs the role change and spawns an async task to send a control message</span>
<span class="sd">        acknowledging the update to the initiating node.</span>

<span class="sd">        Raises:</span>
<span class="sd">            Any exceptions from change_role_behavior or communication logic.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">update_role_needed</span><span class="p">():</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting Role Behavior modification...&quot;</span><span class="p">)</span>
            <span class="n">from_role</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_role_name</span><span class="p">()</span>
            <span class="n">next_role</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_next_role</span><span class="p">()</span>
            <span class="n">source_to_notificate</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_source_to_notificate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_role_behavior</span><span class="p">:</span> <span class="n">RoleBehavior</span> <span class="o">=</span> <span class="n">change_role_behavior</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="p">,</span> <span class="n">next_role</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
            <span class="n">to_role</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_role_name</span><span class="p">()</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Role behavior changing from: </span><span class="si">{</span><span class="n">from_role</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_role</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_role</span>
            <span class="k">if</span> <span class="n">source_to_notificate</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sending role modification ACK to transferer: </span><span class="si">{</span><span class="n">source_to_notificate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="s2">&quot;control&quot;</span><span class="p">,</span> <span class="s2">&quot;leadership_transfer_ack&quot;</span><span class="p">)</span>
                <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">source_to_notificate</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_learning_cycle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Main asynchronous loop for executing the Federated Learning process across multiple rounds.</span>

<span class="sd">        This method orchestrates the entire lifecycle of each federated learning round, including:</span>
<span class="sd">        1. Starting each round:</span>
<span class="sd">        - Updating the list of federation nodes.</span>
<span class="sd">        - Publishing a `RoundStartEvent` for local and global monitoring.</span>
<span class="sd">        - Preparing the trainer and aggregator components.</span>
<span class="sd">        2. Running the core learning logic via `_extended_learning_cycle`.</span>
<span class="sd">        3. Ending each round:</span>
<span class="sd">        - Publishing a `RoundEndEvent`.</span>
<span class="sd">        - Releasing and updating the current round state in the configuration.</span>
<span class="sd">        - Invoking callbacks for the trainer to handle end-of-round logic.</span>

<span class="sd">        After completing all rounds:</span>
<span class="sd">        - Finalizes the trainer by calling `on_learning_cycle_end()` and optionally performs testing.</span>
<span class="sd">        - Reports the scenario status to the controller if required.</span>
<span class="sd">        - Optionally stops the Docker container if deployed in a containerized environment.</span>

<span class="sd">        This function blocks (awaits) until the full FL process concludes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_round_in_process_lock</span><span class="p">:</span>
                <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">print_msg_box</span><span class="p">(</span>
                    <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Round </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> started (max. </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="si">}</span><span class="s2"> rounds)&quot;</span><span class="p">,</span>
                    <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Round information&quot;</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_self_role</span><span class="p">()</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Federation nodes: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">federation_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_federation_nodes</span><span class="p">(</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">only_direct</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">myself</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">expected_nodes</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">select_nodes_to_wait</span><span class="p">()</span>
                <span class="n">rse</span> <span class="o">=</span> <span class="n">RoundStartEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="p">,</span> <span class="n">current_time</span><span class="p">,</span> <span class="n">expected_nodes</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">publish_node_event</span><span class="p">(</span><span class="n">rse</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">on_round_start</span><span class="p">()</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Expected nodes: </span><span class="si">{</span><span class="n">expected_nodes</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">direct_connections</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">only_direct</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">undirected_connections</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_addrs_current_connections</span><span class="p">(</span><span class="n">only_undirected</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Direct connections: </span><span class="si">{</span><span class="n">direct_connections</span><span class="si">}</span><span class="s2"> | Undirected connections: </span><span class="si">{</span><span class="n">undirected_connections</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[Role </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_role_name</span><span class="p">()</span><span class="si">}</span><span class="s2">] Starting learning cycle...&quot;</span><span class="p">)</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregator</span><span class="o">.</span><span class="n">update_federation_nodes</span><span class="p">(</span><span class="n">expected_nodes</span><span class="p">)</span>
                <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_role_behavior_performance_lock</span><span class="p">:</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">extended_learning_cycle</span><span class="p">()</span>

                <span class="n">current_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="n">ree</span> <span class="o">=</span> <span class="n">RoundEndEvent</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="p">,</span> <span class="n">current_time</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">publish_node_event</span><span class="p">(</span><span class="n">ree</span><span class="p">)</span>

                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round_lock</span><span class="p">()</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>

                <span class="n">print_msg_box</span><span class="p">(</span>
                    <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Round </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">round</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> finished (max. </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="si">}</span><span class="s2"> rounds)&quot;</span><span class="p">,</span>
                    <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Round information&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="c1"># await self.aggregator.reset()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">on_round_end</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;federation_args&quot;</span><span class="p">][</span><span class="s2">&quot;round&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">round</span>
                <span class="p">)</span>  <span class="c1"># Set current round in config (send to the controller)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>

        <span class="c1"># End of the learning cycle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">on_learning_cycle_end</span><span class="p">()</span>

        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">test</span><span class="p">()</span>

        <span class="c1"># Shutdown protocol</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_protocol</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_shutdown_protocol</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting graceful shutdown process...&quot;</span><span class="p">)</span>

        <span class="c1"># 1.- Publish Experiment Finish Event to the last update on modules</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Publishing Experiment Finish Event...&quot;</span><span class="p">)</span>
        <span class="n">efe</span> <span class="o">=</span> <span class="n">ExperimentFinishEvent</span><span class="p">()</span>
        <span class="k">await</span> <span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">publish_node_event</span><span class="p">(</span><span class="n">efe</span><span class="p">)</span>

        <span class="c1"># 2.- Log finish message</span>
        <span class="n">print_msg_box</span><span class="p">(</span>
            <span class="n">msg</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;FL process has been completed successfully (max. </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">total_rounds</span><span class="si">}</span><span class="s2"> rounds reached)&quot;</span><span class="p">,</span>
            <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">title</span><span class="o">=</span><span class="s2">&quot;End of the experiment&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="c1"># Report</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;scenario_args&quot;</span><span class="p">][</span><span class="s2">&quot;controller&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;nebula-test&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reporter</span><span class="o">.</span><span class="n">report_scenario_finished</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;📝  Scenario finished reported successfully&quot;</span><span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">reporter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;📝  Error reporting scenario finished&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📝  Error during scenario finish report: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Call centralized shutdown</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
        <span class="k">return</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;🚦 Engine shutdown initiated&quot;</span><span class="p">)</span>

        <span class="c1"># Stop addon services first</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addon_manager</span><span class="o">.</span><span class="n">stop_additional_services</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error stopping add-ons: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="c1"># Stop reporter</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reporter</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error stopping reporter: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="c1"># Stop communications manager (includes forwarder, discoverer, propagator, ECS)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error stopping communications manager: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="c1"># Stop situational awareness</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sa</span><span class="p">:</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">sa</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Error stopping situational awareness: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>

        <span class="c1"># Task cleanup with improved handling</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting graceful task cleanup...&quot;</span><span class="p">)</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">all_tasks</span><span class="p">()</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">current_task</span><span class="p">()]</span>

        <span class="k">if</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span><span class="si">}</span><span class="s2"> remaining tasks to clean up&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • Task: </span><span class="si">{</span><span class="n">task</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">task</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  • State: </span><span class="si">{</span><span class="n">task</span><span class="o">.</span><span class="n">_state</span><span class="si">}</span><span class="s2"> - Done: </span><span class="si">{</span><span class="n">task</span><span class="o">.</span><span class="n">done</span><span class="p">()</span><span class="si">}</span><span class="s2"> - Cancelled: </span><span class="si">{</span><span class="n">task</span><span class="o">.</span><span class="n">cancelled</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Wait for tasks to complete naturally with shorter timeout</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="s2">&quot;Timeout reached during task cleanup (CancelledError); proceeding with shutdown anyway.&quot;</span>
                <span class="p">)</span>
                <span class="c1"># Do not re-raise, just continue</span>
            <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Some tasks did not complete in time, forcing cancellation...&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">task</span><span class="o">.</span><span class="n">done</span><span class="p">():</span>
                        <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
                <span class="c1"># Wait a bit more for cancellations to take effect</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="s2">&quot;Timeout reached during forced cancellation (CancelledError); proceeding with shutdown anyway.&quot;</span>
                    <span class="p">)</span>
                    <span class="c1"># Do not re-raise, just continue</span>
                <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Some tasks still not responding to cancellation&quot;</span><span class="p">)</span>
                    <span class="c1"># Final aggressive cleanup - cancel all remaining tasks</span>
                    <span class="n">remaining_tasks</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">all_tasks</span><span class="p">()</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">current_task</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">t</span><span class="o">.</span><span class="n">done</span><span class="p">()</span>
                    <span class="p">]</span>
                    <span class="k">if</span> <span class="n">remaining_tasks</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Forcing cancellation of </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">remaining_tasks</span><span class="p">)</span><span class="si">}</span><span class="s2"> remaining tasks&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">remaining_tasks</span><span class="p">:</span>
                            <span class="n">task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">asyncio</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">remaining_tasks</span><span class="p">,</span> <span class="n">return_exceptions</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                        <span class="k">except</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">CancelledError</span><span class="p">:</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                                <span class="s2">&quot;Timeout reached during final forced cancellation (CancelledError); proceeding with shutdown anyway.&quot;</span>
                            <span class="p">)</span>
                            <span class="c1"># Do not re-raise, just continue</span>
                        <span class="k">except</span> <span class="ne">TimeoutError</span><span class="p">:</span>
                            <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="s2">&quot;Some tasks still not responding to forced cancellation&quot;</span><span class="p">)</span>
            <span class="c1"># Proceed anyway after all cancellation attempts</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Proceeding with shutdown even if some tasks are still pending/cancelled.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No remaining tasks to clean up.&quot;</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;✅ Engine shutdown complete&quot;</span><span class="p">)</span>

        <span class="c1"># Kill Docker container if running in Docker</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;scenario_args&quot;</span><span class="p">][</span><span class="s2">&quot;deployment&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;docker&quot;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">docker_id</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📦  Removing docker container with ID </span><span class="si">{</span><span class="n">docker_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">container</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">containers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">docker_id</span><span class="p">)</span>
                <span class="n">container</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📦  Successfully removed docker container </span><span class="si">{</span><span class="n">docker_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📦  Error removing Docker container </span><span class="si">{</span><span class="n">docker_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="c1"># Try to force kill the container as last resort</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

                    <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;docker&quot;</span><span class="p">,</span> <span class="s2">&quot;rm&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="n">docker_id</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📦  Forced removal of container </span><span class="si">{</span><span class="n">docker_id</span><span class="si">}</span><span class="s2"> via subprocess&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">sub_e</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📦  Failed to force remove container </span><span class="si">{</span><span class="n">docker_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">sub_e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="nebula.core.engine.Engine.aggregator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">aggregator</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#nebula.core.engine.Engine.aggregator" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Aggregator</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="nebula.core.engine.Engine.cm" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cm</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#nebula.core.engine.Engine.cm" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Communication Manager</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="nebula.core.engine.Engine.rb" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">rb</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#nebula.core.engine.Engine.rb" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Role Behavior</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="nebula.core.engine.Engine.reporter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reporter</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#nebula.core.engine.Engine.reporter" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Reporter</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="nebula.core.engine.Engine.sa" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sa</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#nebula.core.engine.Engine.sa" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Situational Awareness Module</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="nebula.core.engine.Engine.trainer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">trainer</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#nebula.core.engine.Engine.trainer" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Trainer</p>

    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="nebula.core.engine.Engine.broadcast_models_include" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">broadcast_models_include</span><span class="p">(</span><span class="n">age</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nebula.core.engine.Engine.broadcast_models_include" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Broadcasts a message to federation neighbors indicating that aggregation is ready.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>age</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="AggregationEvent (nebula.core.nebulaevents.AggregationEvent)" href="../nebulaevents/#nebula.core.nebulaevents.AggregationEvent">AggregationEvent</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The event containing information about the completed aggregation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<details class="sends" open>
  <summary>Sends</summary>
  <p>federation_models_included: A message containing the round number of the aggregation.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>nebula/core/engine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">broadcast_models_include</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">age</span><span class="p">:</span> <span class="n">AggregationEvent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Broadcasts a message to federation neighbors indicating that aggregation is ready.</span>

<span class="sd">    Args:</span>
<span class="sd">        age (AggregationEvent): The event containing information about the completed aggregation.</span>

<span class="sd">    Sends:</span>
<span class="sd">        federation_models_included: A message containing the round number of the aggregation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔄  Broadcasting MODELS_INCLUDED for round </span><span class="si">{</span><span class="k">await</span><span class="w"> </span><span class="bp">self</span><span class="o">.</span><span class="n">get_round</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">current_round</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_round</span><span class="p">()</span>
    <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span>
        <span class="s2">&quot;federation&quot;</span><span class="p">,</span> <span class="s2">&quot;federation_models_included&quot;</span><span class="p">,</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span> <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">[</span><span class="n">current_round</span><span class="p">]]</span>
    <span class="p">)</span>
    <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">send_message_to_neighbors</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="nebula.core.engine.Engine.deploy_components" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">deploy_components</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nebula.core.engine.Engine.deploy_components" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initializes and deploys the core components required for node operation in the federation.</p>
<p>This method performs the following actions:
1. Initializes the aggregator, which handles the model aggregation process.
2. Optionally initializes the situational awareness module if enabled in the configuration.
3. Sets up the reputation system if enabled.
4. Starts the reporting service for logging and monitoring purposes.
5. Deploys any additional add-ons registered via the addon manager.</p>
<p>This method ensures all critical and optional components are ready before
the federated learning process starts.</p>


            <details class="quote">
              <summary>Source code in <code>nebula/core/engine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">deploy_components</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes and deploys the core components required for node operation in the federation.</span>

<span class="sd">    This method performs the following actions:</span>
<span class="sd">    1. Initializes the aggregator, which handles the model aggregation process.</span>
<span class="sd">    2. Optionally initializes the situational awareness module if enabled in the configuration.</span>
<span class="sd">    3. Sets up the reputation system if enabled.</span>
<span class="sd">    4. Starts the reporting service for logging and monitoring purposes.</span>
<span class="sd">    5. Deploys any additional add-ons registered via the addon manager.</span>

<span class="sd">    This method ensures all critical and optional components are ready before</span>
<span class="sd">    the federated learning process starts.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">aggregator</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
    <span class="k">if</span> <span class="s2">&quot;situational_awareness&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">sa</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;defense_args&quot;</span><span class="p">][</span><span class="s2">&quot;reputation&quot;</span><span class="p">][</span><span class="s2">&quot;enabled&quot;</span><span class="p">]:</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reputation</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reporter</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addon_manager</span><span class="o">.</span><span class="n">deploy_additional_services</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="nebula.core.engine.Engine.deploy_federation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">deploy_federation</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nebula.core.engine.Engine.deploy_federation" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Manages the startup logic for the federated learning process.</p>
<p>The behavior is determined by the configuration:
- If the device is responsible for starting the federation:
1. Waits for a configured grace period to allow peers to initialize.
2. Waits until the network is ready (all nodes are prepared).
3. Sends a 'FEDERATION_START' message to notify neighbors.
4. Initializes the trainer module and marks the node as ready.</p>
<ul>
<li>If the device is not the starter:</li>
<li>Sends a 'FEDERATION_READY' message to neighbors.</li>
<li>Waits passively for a start signal from the initiating node.</li>
</ul>
<p>This function ensures proper synchronization and coordination before the federated rounds begin.</p>


            <details class="quote">
              <summary>Source code in <code>nebula/core/engine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">deploy_federation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Manages the startup logic for the federated learning process.</span>

<span class="sd">    The behavior is determined by the configuration:</span>
<span class="sd">    - If the device is responsible for starting the federation:</span>
<span class="sd">    1. Waits for a configured grace period to allow peers to initialize.</span>
<span class="sd">    2. Waits until the network is ready (all nodes are prepared).</span>
<span class="sd">    3. Sends a &#39;FEDERATION_START&#39; message to notify neighbors.</span>
<span class="sd">    4. Initializes the trainer module and marks the node as ready.</span>

<span class="sd">    - If the device is not the starter:</span>
<span class="sd">    1. Sends a &#39;FEDERATION_READY&#39; message to neighbors.</span>
<span class="sd">    2. Waits passively for a start signal from the initiating node.</span>

<span class="sd">    This function ensures proper synchronization and coordination before the federated rounds begin.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">federation_ready_lock</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;start&quot;</span><span class="p">]:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;💤  Waiting for </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s1">&#39;misc_args&#39;</span><span class="p">][</span><span class="s1">&#39;grace_time_start_federation&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> seconds to start the federation&quot;</span>
        <span class="p">)</span>
        <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;misc_args&quot;</span><span class="p">][</span><span class="s2">&quot;grace_time_start_federation&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">round</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">check_federation_ready</span><span class="p">():</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sending FEDERATION_START to neighbors...&quot;</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="s2">&quot;federation&quot;</span><span class="p">,</span> <span class="s2">&quot;federation_start&quot;</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">send_message_to_neighbors</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_federation_ready_lock</span><span class="p">()</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_trainer_module</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_initialization_status</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Federation already started&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sending FEDERATION_READY to neighbors...&quot;</span><span class="p">)</span>
        <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="s2">&quot;federation&quot;</span><span class="p">,</span> <span class="s2">&quot;federation_ready&quot;</span><span class="p">)</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">send_message_to_neighbors</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;💤  Waiting until receiving the start signal from the start node&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="nebula.core.engine.Engine.resolve_missing_updates" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">resolve_missing_updates</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nebula.core.engine.Engine.resolve_missing_updates" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Delegates the resolution strategy for missing updates to the current role behavior.</p>
<p>This function is called when the node receives no model updates from neighbors
and needs to apply a fallback strategy depending on its role (e.g., using default weights
if aggregator, or local model if trainer).</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the role-specific resolution strategy.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>nebula/core/engine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">resolve_missing_updates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Delegates the resolution strategy for missing updates to the current role behavior.</span>

<span class="sd">    This function is called when the node receives no model updates from neighbors</span>
<span class="sd">    and needs to apply a fallback strategy depending on its role (e.g., using default weights</span>
<span class="sd">    if aggregator, or local model if trainer).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The result of the role-specific resolution strategy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Using Role behavior: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_role_name</span><span class="p">()</span><span class="si">}</span><span class="s2"> conflict resolve strategy&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">resolve_missing_updates</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="nebula.core.engine.Engine.start_communications" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">start_communications</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nebula.core.engine.Engine.start_communications" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initializes communication with neighboring nodes and registers internal event callbacks.</p>
<p>This method performs the following steps:
1. Registers all event callbacks used by the node.
2. Parses the list of initial neighbors from the configuration and initiates communications with them.
3. Waits for half of the configured grace time to allow initial network stabilization.</p>
<p>This grace period provides time for initial peer discovery and message exchange
before other services or training processes begin.</p>


            <details class="quote">
              <summary>Source code in <code>nebula/core/engine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_communications</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes communication with neighboring nodes and registers internal event callbacks.</span>

<span class="sd">    This method performs the following steps:</span>
<span class="sd">    1. Registers all event callbacks used by the node.</span>
<span class="sd">    2. Parses the list of initial neighbors from the configuration and initiates communications with them.</span>
<span class="sd">    3. Waits for half of the configured grace time to allow initial network stabilization.</span>

<span class="sd">    This grace period provides time for initial peer discovery and message exchange</span>
<span class="sd">    before other services or training processes begin.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_events_callbacks</span><span class="p">()</span>
    <span class="n">initial_neighbors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;network_args&quot;</span><span class="p">][</span><span class="s2">&quot;neighbors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">start_communications</span><span class="p">(</span><span class="n">initial_neighbors</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;misc_args&quot;</span><span class="p">][</span><span class="s2">&quot;grace_time_connection&quot;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="nebula.core.engine.Engine.update_model_learning_rate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_model_learning_rate</span><span class="p">(</span><span class="n">new_lr</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nebula.core.engine.Engine.update_model_learning_rate" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Updates the learning rate of the current training model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>new_lr</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The new learning rate to apply to the trainer model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>This method ensures that the operation is protected by a lock to avoid
conflicts with ongoing training operations.</p>


            <details class="quote">
              <summary>Source code in <code>nebula/core/engine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_model_learning_rate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_lr</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the learning rate of the current training model.</span>

<span class="sd">    Args:</span>
<span class="sd">        new_lr (float): The new learning rate to apply to the trainer model.</span>

<span class="sd">    This method ensures that the operation is protected by a lock to avoid</span>
<span class="sd">    conflicts with ongoing training operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainning_in_progress_lock</span><span class="o">.</span><span class="n">acquire_async</span><span class="p">()</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Update | learning rate modified...&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">update_model_learning_rate</span><span class="p">(</span><span class="n">new_lr</span><span class="p">)</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainning_in_progress_lock</span><span class="o">.</span><span class="n">release_async</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="nebula.core.engine.Engine.update_neighbors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_neighbors</span><span class="p">(</span><span class="n">removed_neighbor_addr</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nebula.core.engine.Engine.update_neighbors" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Updates the internal list of federation neighbors and publishes a neighbor update event.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>removed_neighbor_addr</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Address of the neighbor that was removed (or affected).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>neighbors</code>
            </td>
            <td>
                  <code><span title="set">set</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The updated set of current federation neighbors.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>remove</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag indicating whether the specified neighbor was removed (True)
        or added (False).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="publishes" open>
  <summary>Publishes</summary>
  <p>UpdateNeighborEvent: An event describing the neighbor update, for use by listeners.</p>
</details>

            <details class="quote">
              <summary>Source code in <code>nebula/core/engine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">removed_neighbor_addr</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">,</span> <span class="n">remove</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Updates the internal list of federation neighbors and publishes a neighbor update event.</span>

<span class="sd">    Args:</span>
<span class="sd">        removed_neighbor_addr (str): Address of the neighbor that was removed (or affected).</span>
<span class="sd">        neighbors (set): The updated set of current federation neighbors.</span>
<span class="sd">        remove (bool): Flag indicating whether the specified neighbor was removed (True)</span>
<span class="sd">                    or added (False).</span>

<span class="sd">    Publishes:</span>
<span class="sd">        UpdateNeighborEvent: An event describing the neighbor update, for use by listeners.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">update_federation_nodes</span><span class="p">(</span><span class="n">neighbors</span><span class="p">)</span>
    <span class="n">updt_nei_event</span> <span class="o">=</span> <span class="n">UpdateNeighborEvent</span><span class="p">(</span><span class="n">removed_neighbor_addr</span><span class="p">,</span> <span class="n">remove</span><span class="p">)</span>
    <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">EventManager</span><span class="o">.</span><span class="n">get_instance</span><span class="p">()</span><span class="o">.</span><span class="n">publish_node_event</span><span class="p">(</span><span class="n">updt_nei_event</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="nebula.core.engine.Engine.update_self_role" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_self_role</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

<a href="#nebula.core.engine.Engine.update_self_role" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Checks whether a role update is required and performs the transition if necessary.</p>
<p>If a new role has been assigned (i.e., self.rb.update_role_needed() is True),
this function updates the role behavior accordingly and notifies the source
that initiated the role transfer, if applicable.</p>
<p>It logs the role change and spawns an async task to send a control message
acknowledging the update to the initiating node.</p>


            <details class="quote">
              <summary>Source code in <code>nebula/core/engine.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">update_self_role</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks whether a role update is required and performs the transition if necessary.</span>

<span class="sd">    If a new role has been assigned (i.e., self.rb.update_role_needed() is True),</span>
<span class="sd">    this function updates the role behavior accordingly and notifies the source</span>
<span class="sd">    that initiated the role transfer, if applicable.</span>

<span class="sd">    It logs the role change and spawns an async task to send a control message</span>
<span class="sd">    acknowledging the update to the initiating node.</span>

<span class="sd">    Raises:</span>
<span class="sd">        Any exceptions from change_role_behavior or communication logic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">update_role_needed</span><span class="p">():</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting Role Behavior modification...&quot;</span><span class="p">)</span>
        <span class="n">from_role</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_role_name</span><span class="p">()</span>
        <span class="n">next_role</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_next_role</span><span class="p">()</span>
        <span class="n">source_to_notificate</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_source_to_notificate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_role_behavior</span><span class="p">:</span> <span class="n">RoleBehavior</span> <span class="o">=</span> <span class="n">change_role_behavior</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="p">,</span> <span class="n">next_role</span><span class="p">,</span> <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>
        <span class="n">to_role</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rb</span><span class="o">.</span><span class="n">get_role_name</span><span class="p">()</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Role behavior changing from: </span><span class="si">{</span><span class="n">from_role</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">to_role</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">participant</span><span class="p">[</span><span class="s2">&quot;device_args&quot;</span><span class="p">][</span><span class="s2">&quot;role&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_role</span>
        <span class="k">if</span> <span class="n">source_to_notificate</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sending role modification ACK to transferer: </span><span class="si">{</span><span class="n">source_to_notificate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">create_message</span><span class="p">(</span><span class="s2">&quot;control&quot;</span><span class="p">,</span> <span class="s2">&quot;leadership_transfer_ack&quot;</span><span class="p">)</span>
            <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">source_to_notificate</span><span class="p">,</span> <span class="n">message</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="June 26, 2025 13:41:02 UTC">June 26, 2025</span>
  </span>

    
    
    
    
  </aside>



  



                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Created by <a href="https://enriquetomasmb.com">Enrique Tomás Martínez Beltrán</a>, Alberto Huertas Celdrán, Alejandro Avilés Serrano, and Fernando Torres Vega - Source code (AGPL-3.0)
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/CyberDataLab/nebula" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/nebula-dfl" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:enriquetomas@um.es" target="_blank" rel="noopener" title="" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../../js/toc.js"></script>
      
    
  </body>
</html>