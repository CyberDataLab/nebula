
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>nebula.core.datasets.nebuladataset &#8212; NEBULA Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=fd3f3429" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../_static/documentation_options.js?v=f9c1cefe"></script>
    <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/nebula/core/datasets/nebuladataset/index';</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="nebula.core.models" href="../../models/index.html" />
    <link rel="prev" title="nebula.core.datasets.datamodule" href="../datamodule/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../_static/nebula-logo.jpg" class="logo__image only-light" alt="NEBULA Documentation - Home"/>
    <script>document.write(`<img src="../../../../../_static/nebula-logo.jpg" class="logo__image only-dark" alt="NEBULA Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation.html">Installation</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../../index.html">API Reference</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../../index.html">nebula</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../addons/index.html">nebula.addons</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/attacks/index.html">nebula.addons.attacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/blockchain/index.html">nebula.addons.blockchain</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/trustworthiness/index.html">nebula.addons.trustworthiness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/waf/index.html">nebula.addons.waf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/env/index.html">nebula.addons.env</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/functions/index.html">nebula.addons.functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/mobility/index.html">nebula.addons.mobility</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/reporter/index.html">nebula.addons.reporter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../addons/topologymanager/index.html">nebula.addons.topologymanager</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../config/index.html">nebula.config</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../config/config/index.html">nebula.config.config</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../config/mender/index.html">nebula.config.mender</a></li>
</ul>
</details></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../../index.html">nebula.core</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../../aggregation/index.html">nebula.core.aggregation</a></li>
<li class="toctree-l4 current active"><a class="reference internal" href="../index.html">nebula.core.datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../models/index.html">nebula.core.models</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../network/index.html">nebula.core.network</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../pb/index.html">nebula.core.pb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../training/index.html">nebula.core.training</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../utils/index.html">nebula.core.utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../engine/index.html">nebula.core.engine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../eventmanager/index.html">nebula.core.eventmanager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../role/index.html">nebula.core.role</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../frontend/index.html">nebula.frontend</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../frontend/config/index.html">nebula.frontend.config</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../frontend/databases/index.html">nebula.frontend.databases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../frontend/app/index.html">nebula.frontend.app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../frontend/database/index.html">nebula.frontend.database</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../tests/index.html">nebula.tests</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../tests/main/index.html">nebula.tests.main</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../controller/index.html">nebula.controller</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../node/index.html">nebula.node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../scenarios/index.html">nebula.scenarios</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/enriquetomasmb/nebula" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../_sources/api/nebula/core/datasets/nebuladataset/index.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>nebula.core.datasets.nebuladataset</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classes">Classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.logging_training"><code class="docutils literal notranslate"><span class="pre">logging_training</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset"><code class="docutils literal notranslate"><span class="pre">NebulaDataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.num_classes"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.num_classes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition_id"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.partition_id</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partitions_number"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.partitions_number</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.batch_size"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.batch_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.num_workers"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.num_workers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.iid"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.iid</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.partition</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition_parameter"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.partition_parameter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.seed"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.seed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.config"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.config</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.train_set"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.train_set</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.train_indices_map"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.train_indices_map</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.test_set"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.test_set</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.test_indices_map"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.test_indices_map</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.class_distribution"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.class_distribution</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.initialize_dataset"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.initialize_dataset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.generate_non_iid_map"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.generate_non_iid_map()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.generate_iid_map"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.generate_iid_map()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_train_labels"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.get_train_labels()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_test_labels"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.get_test_labels()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_local_test_labels"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.get_local_test_labels()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.plot_data_distribution"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.plot_data_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.visualize_tsne"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.visualize_tsne()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.dirichlet_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.dirichlet_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.homo_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.homo_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.balanced_iid_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.balanced_iid_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.unbalanced_iid_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.unbalanced_iid_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.percentage_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.percentage_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.plot_all_data_distribution"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.plot_all_data_distribution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-nebula.core.datasets.nebuladataset">
<span id="nebula-core-datasets-nebuladataset"></span><h1>nebula.core.datasets.nebuladataset<a class="headerlink" href="#module-nebula.core.datasets.nebuladataset" title="Link to this heading">#</a></h1>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#nebula.core.datasets.nebuladataset.logging_training" title="nebula.core.datasets.nebuladataset.logging_training"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logging_training</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#nebula.core.datasets.nebuladataset.NebulaDataset" title="nebula.core.datasets.nebuladataset.NebulaDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NebulaDataset</span></code></a></p></td>
<td><p>Abstract class for a partitioned dataset.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">#</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.logging_training">
<span class="sig-prename descclassname"><span class="pre">nebula.core.datasets.nebuladataset.</span></span><span class="sig-name descname"><span class="pre">logging_training</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.logging_training" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">nebula.core.datasets.nebuladataset.</span></span><span class="sig-name descname"><span class="pre">NebulaDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partitions_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dirichlet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_parameter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.Dataset</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Abstract class for a partitioned dataset.</p>
<p>Classes inheriting from this class need to implement specific methods
for loading and partitioning the dataset.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.num_classes">
<span class="sig-name descname"><span class="pre">num_classes</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.num_classes" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.partition_id">
<span class="sig-name descname"><span class="pre">partition_id</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition_id" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.partitions_number">
<span class="sig-name descname"><span class="pre">partitions_number</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partitions_number" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.batch_size" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.num_workers">
<span class="sig-name descname"><span class="pre">num_workers</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.num_workers" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.iid">
<span class="sig-name descname"><span class="pre">iid</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.iid" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.partition">
<span class="sig-name descname"><span class="pre">partition</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.partition_parameter">
<span class="sig-name descname"><span class="pre">partition_parameter</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition_parameter" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.seed">
<span class="sig-name descname"><span class="pre">seed</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.seed" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.config">
<span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.config" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.train_set">
<span class="sig-name descname"><span class="pre">train_set</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.train_set" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.train_indices_map">
<span class="sig-name descname"><span class="pre">train_indices_map</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.train_indices_map" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.test_set">
<span class="sig-name descname"><span class="pre">test_set</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.test_set" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.test_indices_map">
<span class="sig-name descname"><span class="pre">test_indices_map</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.test_indices_map" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.class_distribution">
<span class="sig-name descname"><span class="pre">class_distribution</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.class_distribution" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.initialize_dataset">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_dataset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.initialize_dataset" title="Link to this definition">#</a></dt>
<dd><p>Initialize the dataset. This should load or create the dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.generate_non_iid_map">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_non_iid_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dirichlet'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.generate_non_iid_map" title="Link to this definition">#</a></dt>
<dd><p>Create a non-iid map of the dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.generate_iid_map">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">generate_iid_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.generate_iid_map" title="Link to this definition">#</a></dt>
<dd><p>Create an iid map of the dataset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.get_train_labels">
<span class="sig-name descname"><span class="pre">get_train_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_train_labels" title="Link to this definition">#</a></dt>
<dd><p>Get the labels of the training set based on the indices map.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.get_test_labels">
<span class="sig-name descname"><span class="pre">get_test_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_test_labels" title="Link to this definition">#</a></dt>
<dd><p>Get the labels of the test set based on the indices map.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.get_local_test_labels">
<span class="sig-name descname"><span class="pre">get_local_test_labels</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_local_test_labels" title="Link to this definition">#</a></dt>
<dd><p>Get the labels of the local test set based on the indices map.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.plot_data_distribution">
<span class="sig-name descname"><span class="pre">plot_data_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partitions_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.plot_data_distribution" title="Link to this definition">#</a></dt>
<dd><p>Plot the data distribution of the dataset.</p>
<p>Plot the data distribution of the dataset according to the partitions map provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – The dataset to plot (torch.utils.data.Dataset).</p></li>
<li><p><strong>partitions_map</strong> – The map of the dataset partitions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.visualize_tsne">
<span class="sig-name descname"><span class="pre">visualize_tsne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.visualize_tsne" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.dirichlet_partition">
<span class="sig-name descname"><span class="pre">dirichlet_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_samples_per_class</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.dirichlet_partition" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.homo_partition">
<span class="sig-name descname"><span class="pre">homo_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.homo_partition" title="Link to this definition">#</a></dt>
<dd><p>Homogeneously partition the dataset into multiple subsets.</p>
<p>This function divides a dataset into a specified number of subsets, where each subset
is intended to have a roughly equal number of samples. This method aims to ensure a
homogeneous distribution of data across all subsets. It’s particularly useful in
scenarios where a uniform distribution of data is desired among all federated learning
clients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – The dataset to partition. It should have
‘data’ and ‘targets’ attributes.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary where keys are subset indices (ranging from 0 to partitions_number-1)</dt><dd><p>and values are lists of indices corresponding to the samples in each subset.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p>The function randomly shuffles the entire dataset and then splits it into the number
of subsets specified by <cite>partitions_number</cite>. It ensures that each subset has a similar number
of samples. The function also prints the class distribution in each subset for reference.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>federated_data = homo_partition(my_dataset)
# This creates federated data subsets with homogeneous distribution.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.balanced_iid_partition">
<span class="sig-name descname"><span class="pre">balanced_iid_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.balanced_iid_partition" title="Link to this definition">#</a></dt>
<dd><p>Partition the dataset into balanced and IID (Independent and Identically Distributed)
subsets for each client.</p>
<p>This function divides a dataset into a specified number of subsets (federated clients),
where each subset has an equal class distribution. This makes the partition suitable for
simulating IID data scenarios in federated learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dataset</strong> (<em>list</em>) – The dataset to partition. It should be a list of tuples where each
tuple represents a data sample and its corresponding label.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary where keys are client IDs (ranging from 0 to partitions_number-1) and</dt><dd><p>values are lists of indices corresponding to the samples assigned to each client.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p>The function ensures that each class is represented equally in each subset. The
partitioning process involves iterating over each class, shuffling the indices of that class,
and then splitting them equally among the clients. The function does not print the class
distribution in each subset.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>federated_data = balanced_iid_partition(my_dataset)
# This creates federated data subsets with equal class distributions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.unbalanced_iid_partition">
<span class="sig-name descname"><span class="pre">unbalanced_iid_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">imbalance_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.unbalanced_iid_partition" title="Link to this definition">#</a></dt>
<dd><p>Partition the dataset into multiple IID (Independent and Identically Distributed)
subsets with different size.</p>
<p>This function divides a dataset into a specified number of IID subsets (federated
clients), where each subset has a different number of samples. The number of samples
in each subset is determined by an imbalance factor, making the partition suitable
for simulating imbalanced data scenarios in federated learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>list</em>) – The dataset to partition. It should be a list of tuples where
each tuple represents a data sample and its corresponding label.</p></li>
<li><p><strong>imbalance_factor</strong> (<em>float</em>) – The factor to determine the degree of imbalance
among the subsets. A lower imbalance factor leads to more
imbalanced partitions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary where keys are client IDs (ranging from 0 to partitions_number-1) and</dt><dd><p>values are lists of indices corresponding to the samples assigned to each client.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p>The function ensures that each class is represented in each subset but with varying
proportions. The partitioning process involves iterating over each class, shuffling
the indices of that class, and then splitting them according to the calculated subset
sizes. The function does not print the class distribution in each subset.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>federated_data = unbalanced_iid_partition(my_dataset, imbalance_factor=2)
# This creates federated data subsets with varying number of samples based on
# an imbalance factor of 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.percentage_partition">
<span class="sig-name descname"><span class="pre">percentage_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.percentage_partition" title="Link to this definition">#</a></dt>
<dd><p>Partition a dataset into multiple subsets with a specified level of non-IID-ness.</p>
<p>This function divides a dataset into a specified number of subsets (federated
clients), where each subset has a different class distribution. The class
distribution in each subset is determined by a specified percentage, making the
partition suitable for simulating non-IID (non-Independently and Identically
Distributed) data scenarios in federated learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – The dataset to partition. It should have
‘data’ and ‘targets’ attributes.</p></li>
<li><p><strong>percentage</strong> (<em>int</em>) – A value between 0 and 100 that specifies the desired
level of non-IID-ness for the labels of the federated data.
This percentage controls the imbalance in the class distribution
across different subsets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary where keys are subset indices (ranging from 0 to partitions_number-1)</dt><dd><p>and values are lists of indices corresponding to the samples in each subset.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
<p>The function ensures that the number of classes in each subset varies based on the selected
percentage. The partitioning process involves iterating over each class, shuffling the
indices of that class, and then splitting them according to the calculated subset sizes.
The function also prints the class distribution in each subset for reference.</p>
<dl class="simple">
<dt>Example usage:</dt><dd><p>federated_data = percentage_partition(my_dataset, percentage=20)
# This creates federated data subsets with varying class distributions based on
# a percentage of 20.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="nebula.core.datasets.nebuladataset.NebulaDataset.plot_all_data_distribution">
<span class="sig-name descname"><span class="pre">plot_all_data_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partitions_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#nebula.core.datasets.nebuladataset.NebulaDataset.plot_all_data_distribution" title="Link to this definition">#</a></dt>
<dd><p>Plot all of the data distribution of the dataset according to the partitions map provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – The dataset to plot (torch.utils.data.Dataset).</p></li>
<li><p><strong>partitions_map</strong> – The map of the dataset partitions.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../datamodule/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">nebula.core.datasets.datamodule</p>
      </div>
    </a>
    <a class="right-next"
       href="../../models/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">nebula.core.models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classes">Classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.logging_training"><code class="docutils literal notranslate"><span class="pre">logging_training</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset"><code class="docutils literal notranslate"><span class="pre">NebulaDataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.num_classes"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.num_classes</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition_id"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.partition_id</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partitions_number"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.partitions_number</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.batch_size"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.batch_size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.num_workers"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.num_workers</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.iid"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.iid</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.partition</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.partition_parameter"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.partition_parameter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.seed"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.seed</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.config"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.config</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.train_set"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.train_set</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.train_indices_map"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.train_indices_map</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.test_set"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.test_set</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.test_indices_map"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.test_indices_map</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.class_distribution"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.class_distribution</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.initialize_dataset"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.initialize_dataset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.generate_non_iid_map"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.generate_non_iid_map()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.generate_iid_map"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.generate_iid_map()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_train_labels"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.get_train_labels()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_test_labels"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.get_test_labels()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.get_local_test_labels"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.get_local_test_labels()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.plot_data_distribution"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.plot_data_distribution()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.visualize_tsne"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.visualize_tsne()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.dirichlet_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.dirichlet_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.homo_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.homo_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.balanced_iid_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.balanced_iid_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.unbalanced_iid_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.unbalanced_iid_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.percentage_partition"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.percentage_partition()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nebula.core.datasets.nebuladataset.NebulaDataset.plot_all_data_distribution"><code class="docutils literal notranslate"><span class="pre">NebulaDataset.plot_all_data_distribution()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Enrique Tomás Martínez Beltrán
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024, Enrique Tomás Martínez Beltrán.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>