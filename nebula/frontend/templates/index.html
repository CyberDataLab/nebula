{% extends "layout.html" %}
{% block body %}
{{ super() }}

<script>
    // Disable scroll as soon as the body exists
    document.body.style.overflow = 'hidden';
</script>

<!-- Contenedor del video de pantalla completa -->
<div id="intro-video-container" style="position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: black; z-index: 9999; display: flex; justify-content: center; align-items: center;">
    <video id="intro-video" autoplay muted playsinline style="width: 100%; height: 100%; object-fit: cover;">
        <source src="{{ url_for('static', path='videos/intro.mp4') }}" type="video/mp4">
        Your browser does not support the video tag.
    </video>
</div>

<div class="image-container" id="zoom-image-container">
        <img src="{{ url_for('static', path='css/images/imagen_final_v2.PNG') }}" alt="Ventana con persona">  
</div>

<div class="wrapper">
    <div class="content">
        <section id="home" class="section">
            <div class="container" style="text-align: center">
                <h1 class="logo" style="text-align: center">NEBULA: A Platform for Decentralized Federated Learning</h1>
                <p style="text-align: center" class="fst-italic">A cutting-edge platform designed to facilitate the training of
                    federated models within both centralized and decentralized architectures.</p>
                <img id="nebula-logo" src="{{ url_for('static', path='images/nebula-logo.jpg') }}" class="img-fluid"
                    alt="NEBULA Logo" title="NEBULA" style="max-width: 60%; margin: 20px auto;">
            </div>
        </section>

        <section id="colaboration" class="section">
            <div class="container">
                <div class="row">
                    <p style="text-align: center" class="fst-italic">NEBULA is developed by <a href="https://enriquetomasmb.com" target="_blank">Enrique Tomás Martínez Beltrán</a>,
                        <a href="#" target="_blank">Alberto Huertas Celdrán</a>,
                        <a href="#" target="_blank">Alejandro Avilés Serrano</a>, and
                        <a href="#" target="_blank">Fernando Torres Vega</a>
                        <br> in collaboration with the University of Murcia, Armasuisse, and the University of Zurich.</p>
                    <hr>
                    <div
                        class="col-lg-6 col-md-6 col-6 d-flex flex-column align-items-center justify-content-center text-center">
                        <p class="mb-3 fs-8">Download NEBULA and contribute on <i
                                class="fa fa-github fs-5 p-1"></i></p>
                        <a href="https://github.com/CyberDataLab/nebula" target="_blank" class="d-block">
                            <img alt="CyberDataLab/nebula"
                                src="https://img.shields.io/github/stars/CyberDataLab/nebula?style=for-the-badge&logo=github&label=NEBULA&color=success"
                                class="img-fluid">
                        </a>
                    </div>
                    <div
                        class="col-lg-6 col-md-6 col-6 d-flex flex-column align-items-center justify-content-center text-center">
                        <p class="mb-3 fs-8">Join the NEBULA community on <i class="fa fa-discord fs-5 p-1"></i></p>
                        <a href="https://discord.gg/xP5Sp3bWNz" target="_blank" class="d-block">
                            <img alt="https://discord.gg/xP5Sp3bWNz"
                                src="https://img.shields.io/discord/1247893438867701852?style=for-the-badge&logo=discord&label=Discord&color=7289da"
                                class="img-fluid">
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section id="feedback" class="section">
            <div class="container" style="text-align: center">
                <h4 class="mb-4" style="text-align: center">What are you using NEBULA for?</h2>
                    <p style="text-align: center" class="fst-italic">Please let us know how you are
                        using NEBULA and what you think about it. We are open to future collaborations and improvements.</p>
                    <form id="feedback-form">
                        <div class="mb-3">
                            <textarea id="feedbackInput" class="form-control" rows="4"
                                placeholder="I'm using NEBULA to..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-dark" style="float: right">Send Feedback</button>
                    </form>
            </div>
        </section>
    </div>   

    
</div>

<script>
    window.addEventListener('load', () => {
        gsap.registerPlugin(ScrollTrigger);

        const header = document.querySelector('.header'); // Asume que tu header tiene la clase .header
        const footer = document.querySelector('.footer'); // Asume que tu footer tiene la clase .footer

        // Inicialmente ocultamos el header, footer y el contenido principal
        if (header) header.classList.add('initial-hidden');
        if (footer) footer.classList.add('initial-hidden')

        const tl = gsap.timeline({
            scrollTrigger: {
                trigger: '.wrapper',
                start: 'top top',
                end: '+=150%',
                pin: true,
                scrub: true,
                markers: false,
                snap: {
                    snapTo: "end",
                    duration: { min: 0.2, max: 0.5 }, 
                    delay: 0.01, 
                    ease: "power2.inOut" 
                }
            },
            onComplete: () => {
                console.log("¡La animación de zoom y desvanecimiento ha terminado!");
            },
        });

        tl.to('.image-container img', {
            scale: 2,
            z: 350,
            transformOrigin: '37% 50%',
            ease: 'power1.inOut',
        }, 0)
        .to('.image-container', {
            opacity: 0,
            transformOrigin: 'center center',
            ease: 'power1.out'
        }, "-=0.2");
    });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const intro = document.getElementById('intro-video');
    const introContainer = document.getElementById('intro-video-container');
    const body = document.body;
    intro.addEventListener('ended', function () {
        body.style.overflow = 'auto';
        introContainer.classList.add('fade-out');
    });
  });
</script>

<script>
    document.getElementById("feedback-form").addEventListener("submit", function (event) {
        event.preventDefault(); // Prevent the default form submit action

        var feedback = document.getElementById("feedbackInput").value;
        var subject = encodeURIComponent("Feedback on NEBULA");
        var body = encodeURIComponent(feedback);
        var recipientEmail = "enriquetomas@um.es";

        window.location.href = `mailto:${recipientEmail}?subject=${subject}&body=${body}`;
    });
</script>

{% endblock %}
